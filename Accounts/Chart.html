<!DOCTYPE html>
<html lang="en">
<head>
    <base href="./">
    <meta charset="utf-8">
    <meta name="google" content="notranslate" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="description" content="Sports Trading Platform">
    <meta name="keyword" content="sports trading, bet, betfair">
    <title>Chart | BetPro</title>
    <!-- Icons-->
    <link rel="shortcut icon" href="/img/favicon/BetPro.ico">
    <link rel="stylesheet" href="/css/all.css" />
    <link href="/css/style.css" rel="stylesheet" />
    <link href="/css/site.min.css" rel="stylesheet" />
    <link href="/css/BetPro-style.css" rel="stylesheet" />
    <style>
                .cricketEventList {
  list-style: none;
  padding: 0;
  margin: 0;
}

.match-card {
  /* background-color: #1a1a1a; */
  color: white;
  margin-bottom: 12px;
  padding: 12px 16px;
  border-radius: 8px;
  font-size: 16px;
  box-shadow: 0 2px 6px rgba(255, 255, 255, 0.05);
  transition: background 0.3s ease;
  cursor: pointer;
}

.match-card:hover {
  background-color: #2a2a2a;
}
    </style>
    <script>
        var pricesUrl = "https://prices9.mgs11.com/api";
        var ordersUrl = "https://orders.mgs11.com/api";
        const SsocketUrl = "https://orders-ws.mgs11.com/signalr";
        const LiquidityRate = 35;
        let dealerSck = 1;
    </script>
</head>
<body class="app header-fixed sidebar-fixed aside-menu-fixed sidebar-lg-show">
    <header class="app-header navbar">
        <button class="navbar-toggler sidebar-toggler d-lg-none mr-auto" type="button" data-toggle="sidebar-show">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="logo-bar">
            <a href="/index">
                <span class="green-logo-text d-sm-down-none">
                    BetPro
                </span>
            </a>
        </div>

        <button class="navbar-toggler sidebar-toggler d-md-down-none" type="button" data-toggle="sidebar-lg-show">
            <span class="navbar-toggler-icon"></span>
        </button>

        

<ul class="nav navbar-nav d-md-down-none">
        <li class="nav-item px-3">
            <a class="nav-link" href="/index">Dashboard</a>
        </li>
        <li class="nav-item px-3">
            <a class="nav-link" href="/Accounts/Chart">Users</a>
        </li>
        <li class="nav-item px-3">
            <a class="nav-link" href="/Reports/BookDetail">Reports</a>
        </li>
</ul>

        <ul class="nav navbar-nav ml-auto">
            <li class="nav-item px-2">
            <a class="nav-link" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" id="navbar-user">
     <!-- Username & Role will go here  -->
 </a>
                <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" href="/Common/Profile">
                        <i class="fa fa-user"></i> Profile
                    </a>
                    <a class="dropdown-item" id="btn-logout" href="/">
                        <i class="fa fa-sign-out"></i> Logout
                    </a>
                </div>
            </li>
            <li class="nav-item">
             <a class="nav-link" href="/" role="button" aria-haspopup="true" aria-expanded="false">
  <strong>B:</strong> <span class="wallet-balance"></span>
  <strong>Exp:</strong> <span class="wallet-exposure"></span>
</a>
            </li>
        </ul>
    </header>
    <div class="app-body">
        <div class="sidebar">
            <nav class="sidebar-nav">
                

<ul class="nav">
        <li class="nav-item">
            <a class="nav-link" href="/index">
                <i class="nav-icon fas fa-tachometer-alt fa-inverse"></i> Dashboard
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Accounts/Chart">
                <i class="nav-icon fas fa-users fa-inverse"></i> Users
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Markets/Liables">
                <i class="nav-icon fas fa-funnel-dollar fa-inverse"></i> Current Position
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Reports/BookDetail">
                <i class="nav-icon fas fa-money-check fa-inverse"></i> Reports
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Markets/BetLocker">
                <i class="nav-icon fas fa-unlock-alt fa-inverse"></i> Bet Lock
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Markets/Games">
                <i class="nav-icon fas fa-star fa-inverse"></i> Star Casino
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Markets/WorldCasino">
                <i class="nav-icon fas fa-globe fa-inverse"></i> World Casino
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/Markets/ExGames">
                <i class="nav-icon fas fa-globe fa-inverse"></i> BetFair Games
            </a>
        </li>



    <li class="nav-item nav-dropdown">
        <a class="nav-link nav-dropdown-toggle" href="#">
            <img src="/img/v2/soccer.svg" alt="C">
            Soccer
        </a>

        <ul class="nav-dropdown-items footballEventList" href="#">
   
        </ul>
    </li>
    <li class="nav-item nav-dropdown">
        <a class="nav-link nav-dropdown-toggle" href="#">
            <img src="/img/v2/tennis.svg" alt="C">
            Tennis
        </a>

        <ul class="nav-dropdown-items tennisEventList" href="#">
          
        </ul>
    </li>
    <li class="nav-item nav-dropdown">
        <a class="nav-link nav-dropdown-toggle" href="#">
            <img src="/img/v2/cricket.svg" alt="C">
            Cricket
        </a>

        <ul class="nav-dropdown-items cricketEventList"   href="#">
       
        </ul>
    </li>
    <li class="nav-item nav-dropdown">
        <a class="nav-link nav-dropdown-toggle" href="#">
            <img src="/img/v2/horse.svg" alt="C">
            Horse Race
        </a>

        <ul class="nav-dropdown-items horseEventList" href="#">
                
        </ul>
    </li>
    <li class="nav-item nav-dropdown">
        <a class="nav-link nav-dropdown-toggle" href="#">
            <img src="/img/v2/greyhound-racing.svg" alt="C">
            Greyhound
        </a>

        <ul class="nav-dropdown-items greyhounditems" href="#">
            
        </ul>
    </li>
</ul>
            </nav>

            <button class="sidebar-minimizer brand-minimizer" type="button"></button>
        </div>
        <main class="main">
            <div class="container-fluid">
                <div class="animated fadeIn">
                    

<style>
    @media screen and (max-width: 635px) {
        .reportmenubuttons {
            text-align: center;
        }
    }
    
</style>
<div class="row">
    <div class="col-12 col-md-12">
        <div class="card">
            <div class="card-header">
                <i class="fa fa-filter"></i>
                <strong>Report Type</strong>
            </div>
            <div class="card-body reportmenubuttons">
                    <a href="/Reports/BookDetail"
                       id="book-detail"
                       class="btn btn-outline-primary">
                        Book Detail
                    </a>
                    <a href="/Reports/Detail2"
                       id="book-detail-2"
                       class="btn btn-outline-primary">
                        Book Detail 2
                    </a>
                    <a href="/Reports/DailyPl"
                       id="dailyPl"
                       class="btn btn-outline-primary">
                        Daily PL
                    </a>
                    <a href="/Reports/Daily"
                       id="daily"
                       class="btn btn-outline-primary">
                        Daily Report
                    </a>
                    <a href="/Reports/FinalSheet"
                       id="final-sheet"
                       class="btn btn-outline-primary">
                        Final Sheet
                    </a>
                    <a href="/Accounts/Chart?MID=0"
                       id="ledger"
                       class="btn btn-primary">
                        Accounts
                    </a>
                    <a href="/Reports/Commission"
                       id="commission"
                       class="btn btn-outline-primary">
                        Commission Report
                    </a>
            </div>
        </div>
    </div>
</div>


<style>
    *
    /*the container must be positioned relative:*/
    .autocomplete {
    height: 100px;
    position: relative;
    display: inline-block;
    }

    input {
    border: 1px solid transparent;
    background-color: #f1f1f1;
    padding: 10px;
    font-size: 16px;
    }

    input[type=text] {
    background-color: #f1f1f1;
    width: 100%;
    }

    input[type=submit] {
    background-color: DodgerBlue;
    color: #fff;
    cursor: pointer;
    }

    .autocomplete-items {
    position: absolute;
    border: 1px solid #d4d4d4;
    border-bottom: none;
    border-top: none;
    z-index: 99;
    /*position the autocomplete items to be the same width as the container:*/
    top: 100%;
    left: 0;
    right: 0;
    }

    .autocomplete-items div {
    padding: 10px;
    cursor: pointer;
    background-color: #fff;
    border-bottom: 1px solid #d4d4d4;
    }

    /*when hovering an item:*/
    .autocomplete-items div:hover {
    background-color: #e9e9e9;
    }

    /*when navigating through the items using the arrow keys:*/
    .autocomplete-active {
    background-color: DodgerBlue !important;
    color: #ffffff;
    }


    .inputWithIcon input[type="text"] {
    /*padding-left: 40px;*/
    }

    .inputWithIcon {
    position: relative;
    }

    .inputWithIcon img {
    position: absolute;
    left: 0;
    top: 8px;
    margin-left: 170px;
    color: #aaa;
    transition: 0.3s;
    }

    /*.center {
    height: 50px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: -60px;
    }

    #loadingwavebutton{
    height: 50px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: -60px;
    z-index:10;
    position:relative;
    }
    .wave {
    width: 5px;
    height: 50px;
    background: linear-gradient(45deg, #00B181, black);
    margin: 10px;
    animation: wave 1s linear infinite;
    border-radius: 20px;
    }
    .wave:nth-child(2) {
    animation-delay: 0.1s;
    }
    .wave:nth-child(3) {
    animation-delay: 0.2s;
    }
    .wave:nth-child(4) {
    animation-delay: 0.3s;
    }
    .wave:nth-child(5) {
    animation-delay: 0.4s;
    }
    .wave:nth-child(6) {
    animation-delay: 0.5s;
    }
    .wave:nth-child(7) {
    animation-delay: 0.6s;
    }
    .wave:nth-child(8) {
    animation-delay: 0.7s;
    }
    .wave:nth-child(9) {
    animation-delay: 0.8s;
    }
    .wave:nth-child(10) {
    animation-delay: 0.9s;
    }

    @keyframes wave {
    0% {
    transform: scale(0);
    }
    50% {
    transform: scale(1);
    }
    100% {
    transform: scale(0);
    }*/

    

</style>

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <div class="card col-12" id="Usersearchcustom" style="height:140px;">
        <div class="card-header">
            <i class="fa fa-filter"></i>
            <strong>Search-Users</strong>
        </div>
        <div class="card-body" style="padding-bottom:0px; margin:0px;">
            <div class="row" id="searchUsers">
                <form class="form-horizontal" v-on:submit.prevent="search" autocomplete="off">
                    <div class="form-group row">
                        <div class="col-12 autocomplete">
                            <div class="input-group">
                                <div class="inputWithIcon">
                                    <input class="form-control" type="search" placeholder="Username" v-model="query" id="myInput">
                                </div>
                                <span class="input-group-prepend">
                                    <button id="myBtn" class="btn btn-primary" type="button" v-on:click="search">
                                        <i class="fa fa-search"></i> Search
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </form>

                <img src="/img/preloader.gif" v-show="isLoading" style="height:20px;" />
                <nav aria-label="breadcrumb" class="col-12 col-md-6" id="breadcrumbcustom" v-show="!isLoading && users.length > 0">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item" v-for="(user, index) in users">
                            <a :href="'/Accounts?MID=' + user.id" v-if="user.type !== 4">{{ user.username }}</a>
                            <a :href="'/Users/Edit?id=' + user.id" v-if="user.type === 4">{{ user.username }}</a>
                        </li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
    <div class="row" id="accountsChart">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5>
                        <strong>Chek10</strong> - Clients List | Default
                    </h5>
                </div>
                <div class="card-body" style="padding-bottom: 0;">
                    <div id="Tabletoreplace" class="row col-12" style="overflow-x: auto; ">
                        <table class="table table-bordered table-sm">
                            <tr>
                                <th>Credit Remaining</th>
                                <th>Cash</th>
                                <th>P/L Downline</th>
                                <th>Users</th>
                            </tr>
                            <tr>
                                <th>
                                    <a class="btn-block d-flex justify-content-between align-items-center" href="#"
                                    onclick="show_popup('/accounts/ledger?accountId=5736736'); return false;">
                                        <span class="position-plus">
                                            0
                                        </span>
                                    </a>

                                </th>
                                <th>
                                    <a class="btn-block d-flex justify-content-between align-items-center" href="#"
                                    onclick="show_popup('/accounts/ledger?accountId=5736737'); return false;">
                                        <span class="position-plus">
                                            0
                                        </span>
                                    </a>

                                </th>
                                <th>
                                    <a class="btn-block d-flex justify-content-between align-items-center" href="#"
                                    onclick="show_popup('/accounts/ledger?accountId=5736735'); return false;">
                                        <span class="position-plus">
                                            0
                                        </span>
                                    </a>

                                </th>
                                <th>3</th>
                            </tr>
                        </table>
                    </div>



                        <a href="/Users/Create" type="button" class="btn btn-sm btn-primary">
                            <i class="fa fa-user-o"></i>
                            <strong>New User</strong>
                        </a>

                    <a href="/Accounts/Ledger" type="button" class="btn btn-sm btn-primary" target="_blank">
                        <i class="fa fa-book"></i>
                        <strong>Account Ledger</strong>
                    </a>

                    <p class="float-right">
                        <span class="btn btn-sm btn-warning">
                            <strong>C</strong>
                        </span>
                        Cash / Credit
                        <span class="btn btn-sm btn-primary">
                            <i class="fas fa-pencil-alt"></i>
                        </span>
                        Edit
                        <span class="btn btn-sm btn-info">
                            <strong>L</strong>
                        </span>
                        Ledger
                        <span class="btn btn-sm btn-success">
                            <strong>A</strong>
                        </span>
                        Active
                        <span class="btn btn-sm btn-outline-danger">
                            <strong>D</strong>
                        </span>
                        InActive
                    </p>
                </div>

                <div class="card-body">
                    <table id="tableLedger" style="width:100%" class="display table table-bordered table-striped  tbl-datatable1">
                        <thead>
                            <tr class="accounts-chart-head-bg">
                                <th colspan="9">
                                    <img id="accountLoadGif" src="/img/preloader.gif" style="display: none;" />
                                    <a href="" onclick="LoadFullAccounts(5202744); return false;" type="button" class="btn btn-warning">
                                        <strong>Load Balance</strong>
                                    </a>
                                </th>
                            </tr>
                            <tr>
                                <th>Username</th>
                                <th>Type</th>
                                <th>Credit</th>
                                <th>Balance</th>
                                <th>Client (P/L)</th>
                                <th>Share</th>
                                <th>Exposure</th>
                                <th>Available Balance</th>
                                <th>Options</th>
                            </tr>
                        </thead>
                        <tbody id="downlineTableBody">
  <!-- yaha JS se inject hoga -->
</tbody>
                        <!-- <tbody>
                                <tr id="row-5269980">
                                    <td>
                                            <a href="/Accounts/Chart?MID=5269980">
                                                <strong>alsSmaster</strong>
                                            </a>
                                                <span style="float:right"><button class="btn" onclick="ShowBookRow(5202744, 5269980)"><i class="fas fa-info-circle flag-icon-sm"></i></button></span>
                                    </td>
                                    <td>SuperMaster</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td align="right" style="padding-right:24px;">
                                            <a class="btn btn-warning" href="/Accounts/Cash?id=5269980" onclick="popup_hawala('/Accounts/Cash', 5269980);return false;">
                                                <strong>C</strong>
                                            </a>

                                        <a class="btn btn-primary" target="_blank" href="/Users/Edit?id=5269980">
                                            <i class="fas fa-pencil-alt"></i>
                                        </a>

                                            <a class="btn btn-info" href="#"
                                               onclick="show_popup('/accounts/ledger?accountId=5810487'); return false;">
                                                <strong>L</strong>
                                            </a>
                                                <a class="btn btn-outline-danger" target="_blank" href="/Users/Edit?id=5269980">
                                                    <strong>D</strong>
                                                </a>
                                </td>
                            </tr>
                                <tr id="row-5373314">
                                    <td>
                                            <a href="/Accounts/Chart?MID=5373314">
                                                <strong>dhoni2025</strong>
                                            </a>
                                                <span style="float:right"><button class="btn" onclick="ShowBookRow(5202744, 5373314)"><i class="fas fa-info-circle flag-icon-sm"></i></button></span>
                                    </td>
                                    <td>SuperMaster</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td align="right" style="padding-right:24px;">
                                            <a class="btn btn-warning" href="/Accounts/Cash?id=5373314" onclick="popup_hawala('/Accounts/Cash', 5373314);return false;">
                                                <strong>C</strong>
                                            </a>

                                        <a class="btn btn-primary" target="_blank" href="/Users/Edit?id=5373314">
                                            <i class="fas fa-pencil-alt"></i>
                                        </a>

                                            <a class="btn btn-info" href="#"
                                               onclick="show_popup('/accounts/ledger?accountId=5921999'); return false;">
                                                <strong>L</strong>
                                            </a>
                                                <a class="btn btn-outline-danger" target="_blank" href="/Users/Edit?id=5373314">
                                                    <strong>D</strong>
                                                </a>
                                </td>
                            </tr>
                                <tr id="row-5270105">
                                    <td>
                                            <a href="/Accounts/Chart?MID=5270105">
                                                <strong>testSmaster</strong>
                                            </a>
                                                <span style="float:right"><button class="btn" onclick="ShowBookRow(5202744, 5270105)"><i class="fas fa-info-circle flag-icon-sm"></i></button></span>
                                    </td>
                                    <td>SuperMaster</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td>-</td>
                                    <td align="right" style="padding-right:24px;">
                                            <a class="btn btn-warning" href="/Accounts/Cash?id=5270105" onclick="popup_hawala('/Accounts/Cash', 5270105);return false;">
                                                <strong>C</strong>
                                            </a>

                                        <a class="btn btn-primary" target="_blank" href="/Users/Edit?id=5270105">
                                            <i class="fas fa-pencil-alt"></i>
                                        </a>

                                            <a class="btn btn-info" href="#"
                                               onclick="show_popup('/accounts/ledger?accountId=5810628'); return false;">
                                                <strong>L</strong>
                                            </a>
                                                <a class="btn btn-outline-danger" target="_blank" href="/Users/Edit?id=5270105">
                                                    <strong>D</strong>
                                                </a>
                                </td>
                            </tr>
                        </tbody> -->
                    </table>
                </div>
            </div>
        </div>
    </div>



<script>
async function loadDownlineUsers(parentId = null) {
  const token = localStorage.getItem("token");
  const tbody = document.getElementById("downlineTableBody");

  console.log("Loading users for parentId:", parentId);

  tbody.innerHTML = `<tr><td colspan="9" class="text-center">Loading...</td></tr>`;

  try {
    const url = `https://bettingbackending.work.gd/api/users/my-downline${parentId ? `?parentId=${parentId}` : ''}`;
    console.log("Fetching URL:", url);

    const res = await fetch(url, {
      headers: {
        "Authorization": `Bearer ${token}`
      },
      cache: 'no-store'
    });

    const result = await res.json();
    console.log("API Response:", result);

    if (!result.success) {
      throw new Error(result.message || "Failed to load users");
    }

    tbody.innerHTML = "";

    if (!result.users || result.users.length === 0) {
      tbody.innerHTML = `
        <tr>
          <td colspan="9" class="text-center">
            No users found
            ${parentId ? 
              `<button onclick="loadDownlineUsers()" class="btn btn-sm btn-secondary ml-2">
                Back to Main List
              </button>` : 
              ''
            }
          </td>
        </tr>`;
      return;
    }

    // Add user rows
    result.users.forEach(user => {
      const tr = document.createElement("tr");
      tr.id = `row-${user._id}`;

      const isClickable = user.role.toLowerCase() === 'supermaster' || user.role.toLowerCase() === 'master';
      
      tr.innerHTML = `
        <td>
          ${isClickable ? 
            `<a href="javascript:void(0)" onclick="loadDownlineUsers('${user._id}')">
              <strong>${user.username}</strong>
            </a>` : 
            `<strong>${user.username}</strong>`
          }
          <span style="float:right">
            <button class="btn" onclick="ShowBookRow('${user.parent_id}', '${user._id}')">
              <i class="fas fa-info-circle flag-icon-sm"></i>
            </button>
          </span>
        </td>
        <td>${user.role}</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td>-</td>
        <td align="right" style="padding-right:24px;">
          <a class="btn btn-warning" href="/Accounts/Cash?id=${user._id}" onclick="popup_hawala('/Accounts/Cash.html', '${user._id}');return false;">
            <strong>C</strong>
          </a>
          <a class="btn btn-primary" target="_blank" href="/Users/Edit?id=${user._id}">
            <i class="fas fa-pencil-alt"></i>
          </a>
          <a class="btn btn-info" href="#" onclick="show_popup('/accounts/ledger?accountId=${user._id}'); return false;">
            <strong>L</strong>
          </a>
          <a class="btn btn-outline-danger" target="_blank" href="/Users/Edit?id=${user._id}">
            <strong>D</strong>
          </a>
        </td>
      `;
      tbody.appendChild(tr);
    });

    // Add back button if viewing someone's downline
    if (parentId) {
      const backRow = document.createElement("tr");
      backRow.innerHTML = `
        <td colspan="9">
          <button onclick="loadDownlineUsers()" class="btn btn-secondary">
            ← Back to Main List
          </button>
        </td>
      `;
      tbody.insertBefore(backRow, tbody.firstChild);
    }

  } catch (err) {
    console.error("Error loading downline users:", err);
    tbody.innerHTML = `
      <tr>
        <td colspan="9" class="text-center text-danger">
          Error: ${err.message}
          <button onclick="loadDownlineUsers()" class="btn btn-sm btn-secondary ml-2">
            Retry
          </button>
        </td>
      </tr>`;
  }
}

document.addEventListener("DOMContentLoaded", () => loadDownlineUsers());
</script>

<script>
    function popup_hawala(Url, ClientId) {
        var url = Url + "?id=" + ClientId;
        newwindow = window.open(url, "Cash Hawala", 'height=800,width=650,titlebar=0,menubar=0');
        if (window.focus) { newwindow.focus() }
        return false;
    }
    function show_popup(Url, Title) {
        newwindow = window.open(Url, Title, 'height=800,width=900,titlebar=0,menubar=0');
        if (window.focus) { newwindow.focus() }
        return false;
    }
</script>
  <script>
document.addEventListener("DOMContentLoaded", async () => {
  const token = localStorage.getItem("token");
  if (!token) return;

  try {
    const res = await fetch("https://bettingbackending.work.gd/api/users/latest", {
      headers: { "Authorization": "Bearer " + token }
    });
    const data = await res.json();

    if (data.success && data.user) {
      const user = data.user;

      // update localStorage (optional)
      localStorage.setItem("user", JSON.stringify(user));

      // Username
      document.getElementById("navbar-user").innerHTML =
        `${user.username} (${user.role}) <i class="fas fa-caret-down"></i>`;

      // Balance
      const walletBalance = document.querySelector(".wallet-balance");
      if (walletBalance) walletBalance.textContent = user.wallet_balance ?? "0";

      // Exposure
      const walletExposure = document.querySelector(".wallet-exposure");
      if (walletExposure) walletExposure.textContent = user.wallet_exposure ?? "0";
    }
  } catch (err) {
    console.error("Error loading latest user info:", err);
  }
});

</script>


                </div>
            </div>
        </main>
    </div>

     <div class="modal fade" id="modalMarketRules" tabindex="-1" role="dialog" aria-labelledby="modalMarketRules" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Market Rules</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div id="market-rules-text" class="modal-body">
                </div>
            </div>
        </div>
    </div>

    <footer class="app-footer">
    <ul id="news-ticker-foot">
        <li data-update="item1">Welcome to BetPro</li>
    </ul>
</footer>
<!-- CoreUI and necessary plugins-->

<script type="text/javascript" src="https://wurfl.io/wurfl.js"></script>
<script src="/js/signalr/dist/browser/signalr.js"></script>


    <script src="/js/vue.min.js"></script>
    <script src="https://unpkg.com/vuex@3.1.3/dist/vuex.min.js"></script>
    <script src="/js/site.min.js"></script>
    <script src="/js/bof.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-C1WVLP1K0K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('set', { 'user_id': 'Chek10' });
        gtag('config', 'G-C1WVLP1K0K');
    </script>


<script type="text/javascript" src="/js/tempusdominus-bootstrap-4.min.js"></script>
<script src="/js/src/client-locales.js"></script>

    
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script>
document.addEventListener("DOMContentLoaded", () => {
  const userInfo = localStorage.getItem("user");
  if (userInfo) {
    const user = JSON.parse(userInfo);
    const navbarUser = document.getElementById("navbar-user");
    navbarUser.innerHTML = `${user.username} (${user.role}) <i class="fas fa-caret-down"></i>`;
  }
});
</script>

    <script>
  function slugify(text) {
    return text
      .toString()
      .toLowerCase()
      .replace(/[^a-z0-9\s]/g, '') // remove special chars
      .replace(/\s+/g, '-')        // space to hyphen
      .trim();
  }

  async function loadCricketMatches() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/cricket');
      const result = await response.json();

      const ul = document.querySelector('.cricketEventList');
      ul.innerHTML = '';

      if (result.status === 'success') {
        if (result.data.length === 0) {
          ul.innerHTML = '<li>No live or upcoming cricket matches found</li>';
          return;
        }

        result.data.forEach(event => {
          const li = document.createElement('li');
          li.classList.add('match-card');

          const matchName = event.match || 'match';
          const matchId = event.marketId || event.eventId || '0'; // fallback if id not found
          const slug = slugify(matchName);

          li.textContent = matchName;
          li.style.cursor = 'pointer';

          li.addEventListener('click', () => {
            window.location.href = `/Common/markets#!${matchId}`;
          });

          ul.appendChild(li);
        });
      } else {
        ul.innerHTML = '<li>Error loading matches</li>';
      }
    } catch (error) {
      console.error('API Error:', error);
      document.querySelector('.cricketEventList').innerHTML =
        '<li>API Error: ' + error.message + '</li>';
    }
  }

  document.addEventListener('DOMContentLoaded', loadCricketMatches);
</script>
<script>
  let lastCricketMatches = []; // cache

  function slugify(text) {
    return text
      .toString()
      .toLowerCase()
      .replace(/[^a-z0-9\s]/g, '') // remove special chars
      .replace(/\s+/g, '-')        // space -> hyphen
      .trim();
  }

  async function loadCricketMatches() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/cricket');
      const result = await response.json();

      if (result.status === 'success' && result.data.length > 0) {
        lastCricketMatches = result.data;
      }

      renderCricketMatches(lastCricketMatches);

    } catch (err) {
      console.error('⚠️ Error loading cricket matches:', err.message);
      renderCricketMatches(lastCricketMatches); // fallback to cache
    }
  }

  function renderCricketMatches(matches) {
    const tableBody = document.querySelector('.cricketEventLis');
    tableBody.innerHTML = ''; // reset

    if (!matches || matches.length === 0) {
      tableBody.innerHTML = `<tr><td colspan="2" style="color:white;">No live cricket matches found.</td></tr>`;
      return;
    }

    matches.forEach(match => {
      const tr = document.createElement('tr');

      // left column (match name + link)
      const td1 = document.createElement('td');
      const h5 = document.createElement('h5');
      const a = document.createElement('a');

      const matchName = match.match || 'Unknown Match';
      const matchId = match.marketId || match.eventId || '0';

      a.href = `/Common/markets#!${matchId}`;
      a.textContent = `${matchName} / Match Odds`;

      h5.appendChild(a);

      // optional icon (same as football)
      const i = document.createElement('i');
      i.className = 'fa fa-circle position-plus';
      h5.appendChild(i);

      td1.appendChild(h5);

      // right column (volume/totalMatched)
      const td2 = document.createElement('td');
      td2.classList.add('position-plus');
      td2.textContent = match.totalMatched?.toLocaleString() || '0';

      tr.appendChild(td1);
      tr.appendChild(td2);

      tableBody.appendChild(tr);
    });
  }

  // Auto load on page load + refresh every 10 sec
  document.addEventListener('DOMContentLoaded', () => {
    loadCricketMatches();
    setInterval(loadCricketMatches, 10000);
  });
</script>
<script>
  let lastFootballMatches = []; // cache last non-empty data

  function slugify(text) {
    return text
      .toString()
      .toLowerCase()
      .replace(/[^a-z0-9\s]/g, '') // remove special chars
      .replace(/\s+/g, '-')        // space to hyphen
      .trim();
  }

  async function loadFootballMatche() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/football');
      const result = await response.json();

      // ✅ Update cache only if API returns non-empty matches
      if (result.status === 'success' && result.data.length > 0) {
        lastFootballMatches = result.data;
      }

      renderFootballMatche(lastFootballMatches);

    } catch (err) {
      console.error('⚠️ Error loading football matches:', err.message);
      renderFootballMatche(lastFootballMatches); // fallback to cache
    }
  }

  function renderFootballMatche(matches) {
    const listContainer = document.querySelector('.footballEventList');
    listContainer.innerHTML = ''; // clear only for re-render

    if (!matches || matches.length === 0) {
      listContainer.innerHTML = '<li style="color:white;">No live football matches found.</li>';
      return;
    }

    matches.forEach(match => {
      const li = document.createElement('li');
      li.classList.add('match-card');

      const matchName = match.match || 'match';
      const matchId = match.marketId || match.eventId || '0';
      const slug = slugify(matchName);

      li.textContent = matchName;
      li.style.cursor = 'pointer';

      li.addEventListener('click', () => {
        window.location.href = `/Common/markets#!${matchId}`;
      });

      listContainer.appendChild(li);
    });
  }

  // Auto load on page load + refresh every 10 seconds
  document.addEventListener('DOMContentLoaded', () => {
    loadFootballMatche();
    setInterval(loadFootballMatche, 10000);
  });
</script>
<script>
  let lastFootballMatche = []; // cache

  function slugify(text) {
    return text
      .toString()
      .toLowerCase()
      .replace(/[^a-z0-9\s]/g, '') // special chars hatado
      .replace(/\s+/g, '-')        // space -> -
      .trim();
  }

  async function loadFootballMatches() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/football');
      const result = await response.json();

      if (result.status === 'success' && result.data.length > 0) {
        lastFootballMatche = result.data;
      }

      renderFootballMatches(lastFootballMatche);

    } catch (err) {
      console.error('⚠️ Error loading football matches:', err.message);
      renderFootballMatches(lastFootballMatche); // fallback
    }
  }

  function renderFootballMatches(matches) {
    const tableBody = document.querySelector('.footballEventLis');
    tableBody.innerHTML = ''; // reset

    if (!matches || matches.length === 0) {
      tableBody.innerHTML = `<tr><td colspan="2" style="color:white;">No live football matches found.</td></tr>`;
      return;
    }

    matches.forEach(match => {
      const tr = document.createElement('tr');

      // left column (match name + link)
      const td1 = document.createElement('td');
      const h5 = document.createElement('h5');
      const a = document.createElement('a');

      const matchName = match.match || 'Unknown Match';
      const matchId = match.marketId || match.eventId || '0';

      a.href = `/Common/markets#!${matchId}`;
      a.textContent = `${matchName} / Match Odds`;

      h5.appendChild(a);

      // optional icon (if you want)
      const i = document.createElement('i');
      i.className = 'fa fa-circle position-plus';
      h5.appendChild(i);

      td1.appendChild(h5);

      // right column (volume or traded amount)
      const td2 = document.createElement('td');
      td2.classList.add('position-plus');
      td2.textContent = match.totalMatched.toLocaleString() || '0';

      tr.appendChild(td1);
      tr.appendChild(td2);

      tableBody.appendChild(tr);
    });
  }

  // Auto load on page load + refresh every 10 sec
  document.addEventListener('DOMContentLoaded', () => {
    loadFootballMatches();
    setInterval(loadFootballMatches, 10000);
  });
</script>


<script>
  let lastTennisMatches = []; // cache last valid tennis data

  function slugify(text) {
    return text
      .toString()
      .toLowerCase()
      .replace(/[^a-z0-9\s]/g, '') // remove special chars
      .replace(/\s+/g, '-')        // space to hyphen
      .trim();
  }

  async function loadTennisMatche() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/tennis');
      const result = await response.json();

      if (result.status === 'success' && result.data.length > 0) {
        lastTennisMatches = result.data; // update cache only if data is valid
      }

      renderTennisMatche(lastTennisMatches);

    } catch (err) {
      console.error('⚠️ Error loading tennis matches:', err.message);
      renderTennisMatche(lastTennisMatches); // fallback to old data
    }
  }

  function renderTennisMatche(matches) {
    const listContainer = document.querySelector('.tennisEventList');
    listContainer.innerHTML = '';

    if (!matches || matches.length === 0) {
      listContainer.innerHTML = '<li style="color:white;">No live tennis matches found.</li>';
      return;
    }

    matches.forEach(match => {
      const li = document.createElement('li');
      li.classList.add('match-card');

      const matchName = match.match || 'match';
      const matchId = match.marketId || match.eventId || '0';
      const slug = slugify(matchName);

      li.textContent = matchName;
      li.style.cursor = 'pointer';

      li.addEventListener('click', () => {
        window.location.href = `/Common/markets#!${matchId}`;
      });

      listContainer.appendChild(li);
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    loadTennisMatche();
    setInterval(loadTennisMatche, 10000); // refresh every 10s
  });
</script>

<script>
  let lastTennisMatche = []; // cache

  function slugify(text) {
    return text
      .toString()
      .toLowerCase()
      .replace(/[^a-z0-9\s]/g, '') // remove special chars
      .replace(/\s+/g, '-')        // space -> hyphen
      .trim();
  }

  async function loadTennisMatches() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/tennis');
      const result = await response.json();

      if (result.status === 'success' && result.data.length > 0) {
        lastTennisMatche = result.data; // update cache
      }

      renderTennisMatches(lastTennisMatche);

    } catch (err) {
      console.error('⚠️ Error loading tennis matches:', err.message);
      renderTennisMatches(lastTennisMatche); // fallback to cache
    }
  }

  function renderTennisMatches(matches) {
    const tableBody = document.querySelector('.tennisEventLis');
    tableBody.innerHTML = ''; // reset

    if (!matches || matches.length === 0) {
      tableBody.innerHTML = `<tr><td colspan="2" style="color:white;">No live tennis matches found.</td></tr>`;
      return;
    }

    matches.forEach(match => {
      const tr = document.createElement('tr');

      // left column (match name + link)
      const td1 = document.createElement('td');
      const h5 = document.createElement('h5');
      const a = document.createElement('a');

      const matchName = match.match || 'Unknown Match';
      const matchId = match.marketId || match.eventId || '0';

      a.href = `/Common/markets#!${matchId}`;
      a.textContent = `${matchName} / Match Odds`;

      h5.appendChild(a);

      // optional icon (same as football/cricket)
      const i = document.createElement('i');
      i.className = 'fa fa-circle position-plus';
      h5.appendChild(i);

      td1.appendChild(h5);

      // right column (volume/totalMatched)
      const td2 = document.createElement('td');
      td2.classList.add('position-plus');
      td2.textContent = match.totalMatched?.toLocaleString() || '0';

      tr.appendChild(td1);
      tr.appendChild(td2);

      tableBody.appendChild(tr);
    });
  }

  // Auto load on page load + refresh every 10 sec
  document.addEventListener('DOMContentLoaded', () => {
    loadTennisMatches();
    setInterval(loadTennisMatches, 10000);
  });
</script>
<script>
  async function loadgreyhoundMatches() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/greyhound');
      const result = await response.json();

      const listContainer = document.querySelector('.greyhounditems');
      listContainer.innerHTML = ''; // Clear existing

      if (result.status === 'success' && result.data.length > 0) {
        result.data.forEach(match => {
          const li = document.createElement('li');
          li.classList.add('match-card'); // ✅ Custom style class

          const startTime = new Date(match.startTime);
          const timeStr = startTime.toLocaleTimeString('en-US', {
            hour: 'numeric',
            minute: '2-digit',
            hour12: true
          }).toLowerCase(); // e.g., "4:50 PM" → "4:50 pm"

          li.textContent = `${timeStr} ${match.match}`;

          // ✅ Redirect on click to market.html with marketId
          li.style.cursor = 'pointer';
          li.addEventListener('click', () => {
            window.location.href = `/Common/markets#!${match.marketId}`;
          });

          listContainer.appendChild(li);
        });
      } else {
        listContainer.innerHTML = '<li style="color:white;">No live horse matches found.</li>';
      }
    } catch (err) {
      console.error('⚠️ Error loading horse matches:', err.message);
    }
  }

  loadgreyhoundMatches(); // auto load on page load
</script>




      

<script>
  async function loadhorseMatches() {
    try {
      const response = await fetch('https://bettingbackending.work.gd/api/markets/live/horse');
      const result = await response.json();

      const listContainer = document.querySelector('.horseEventList');
      listContainer.innerHTML = ''; // Clear existing

      if (result.status === 'success' && result.data.length > 0) {
        result.data.forEach(match => {
          const li = document.createElement('li');
          li.classList.add('match-card'); // ✅ Custom style class

          const startTime = new Date(match.startTime);
          const timeStr = startTime.toLocaleTimeString('en-US', {
            hour: 'numeric',
            minute: '2-digit',
            hour12: true
          }).toLowerCase(); // e.g., "4:50 PM" → "4:50 pm"

          li.textContent = `${timeStr} ${match.match}`;

          // Click handler: Redirect to market.html with marketId or match info
          // Assuming match.marketId exists; agar nahi hai toh backend mein bhi bhejna hoga
          li.style.cursor = 'pointer';  // Cursor pointer for UX
          li.addEventListener('click', () => {
            // MarketId ko query param mein bhej rahe hain
            window.location.href = `/Common/markets#!${match.marketId}`;
          });

          listContainer.appendChild(li);
        });
      } else {
        listContainer.innerHTML = '<li style="color:white;">No live horse matches found.</li>';
      }
    } catch (err) {
      console.error('⚠️ Error loading horse matches:', err.message);
    }
  }

  loadhorseMatches(); // auto load on page load
</script>
    <script>
        $(document).ready(function () {
            var tblLed = $("#tableLedger").DataTable({
                responsive: true,
                paging: false,
                ordering: false,
                // "order": [[0, "asc"]],
                columnDefs: [
                    { responsivePriority: 1, targets: 0 },
                    { responsivePriority: 2, targets: 2 }
                ]
            });

            if (IsMobile()) {
                new $.fn.dataTable.Responsive(tblLed, {
                    details: {
                        display: $.fn.dataTable.Responsive.display.childRowImmediate
                    }
                });
            }
        });
        
        $(function () {
            $("#myInput")
                .on("keydown", function (event) {
                    if (event.keyCode != 13 && event.keyCode != 8) {
                        // document.getElementById('smloading').style.display = 'block';
                        if (event.keyCode === $.ui.keyCode.TAB &&
                            $(this).autocomplete("instance").menu.active) {
                            event.preventDefault();
                        }
                    } else {
                        // document.getElementById('smloading').style.display = 'none';
                    }
                    var ib = document.getElementById("myInput").value;
                    if (ib.length == 0) {
                        //  document.getElementById('smloading').style.display = 'none';
                    }

                })
                .autocomplete({
                    source: function (request, response) {
                        $.getJSON("/api/v2/users", {
                            q: request.term
                        }, response);

                    },
                    search: function () {
                        // custom minLength
                        var term = this.value;
                        if (term.length < 3) {
                            return false;
                        }
                    },
                    focus: function () {
                        // document.getElementById('smloading').style.display = 'none';
                        // prevent value inserted on focus
                        // return false;
                    },
                    select: function (event, ui) {
                        if (searchVM != "undefined") {
                            searchVM.query = ui.item.value;
                            //  document.getElementById('smloading').style.display = 'none';
                        }
                    }

                });
        });

        function ShowUserRow(mid , btid) 
        {
            $.get('/Accounts/Chart?handler=DataSingle&MID=' + mid + "&bettID=" + btid, function (data) {

                if (btid != '')
                {
                            var id = "row-" + btid;
                            var lis = $("#" + id).next('.child').find("li");

                            if (isMobileDevice()) {

                                if (lis.length == 5) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].html = NewData[0].innerHTML;
                                    tds[1].innerText = NewData[1].innerText;
                                    tds[2].innerText = NewData[2].innerText;

                                    lis[0].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[1].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[2].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[3].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[4].innerText = 'Available Balance = ' + NewData[7].innerText;
                                }
                                if (lis.length == 6) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].innerHTML = NewData[0].innerHTML;
                                    tds[2].innerText = NewData[2].innerText;

                                    lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                    lis[1].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[2].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[3].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[4].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[5].innerText = 'Available Balance = ' + NewData[7].innerText;
                                }
                                if (lis.length == 7) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].innerHTML = NewData[0].innerHTML;
                                    lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                    lis[1].innerText = 'Credit - ' + NewData[2].innerText;
                                    lis[2].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[3].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[4].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[5].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[6].innerText = 'Available Balance = ' + NewData[7].innerText;
                                }

                            }
                            else {
                                document.getElementById(id).innerHTML = "";
                                document.getElementById(id).innerHTML = data;
                            }
                }
                else
                {
                            var id = "row-" + mid;
                            var lis = $("#" + id).next('.child').find("li");

                            if (isMobileDevice()) {

                                if (lis.length == 5) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].html = NewData[0].innerHTML;
                                    tds[1].innerText = NewData[1].innerText;
                                    tds[2].innerText = NewData[2].innerText;

                                    lis[0].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[1].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[2].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[3].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[4].innerText = 'Available Balance = ' + NewData[7].innerText;
                                }
                                if (lis.length == 6) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].innerHTML = NewData[0].innerHTML;
                                    tds[2].innerText = NewData[2].innerText;

                                    lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                    lis[1].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[2].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[3].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[4].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[5].innerText = 'Available Balance = ' + NewData[7].innerText;
                                }
                                if (lis.length == 7) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].innerHTML = NewData[0].innerHTML;
                                    lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                    lis[1].innerText = 'Credit - ' + NewData[2].innerText;
                                    lis[2].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[3].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[4].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[5].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[6].innerText = 'Available Balance = ' + NewData[7].innerText;
                                }

                            }
                            else {
                                document.getElementById(id).innerHTML = "";
                                document.getElementById(id).innerHTML = data;
                            }
                }

            });
        }


        function ShowBookRow(mid, btid) {
            $.get('/Accounts/Chart?handler=DataBook&MID=' + mid + "&bettID=" + btid + "&BookVal=" + 'True' , function (data) {

                if (btid != '')
                {

                            var id = "row-" + btid;
                            var lis = $("#" + id).next('.child').find("li");

                            if (isMobileDevice()) {

                                if (lis.length == 6) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].html = NewData[0].innerHTML;
                                    tds[1].innerText = NewData[1].innerText;
                                    tds[2].innerText = NewData[2].innerText;

                                    lis[0].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[1].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[2].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[3].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[4].innerText = 'Available Balance = ' + NewData[7].innerText;
                                    lis[5].innerHTML = NewData[8].innerHTML;
                                }
                                if (lis.length == 7) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].innerHTML = NewData[0].innerHTML;
                                    tds[2].innerText = NewData[2].innerText;

                                    lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                    lis[1].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[2].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[3].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[4].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[5].innerText = 'Available Balance = ' + NewData[7].innerText;
                                    lis[6].innerHTML = NewData[8].innerHTML;
                                }
                                if (lis.length == 8) {
                                    var NewData = $(data).find("tr,td");
                                    var tds = $("#" + id).find("tr,td");
                                    tds[0].innerHTML = NewData[0].innerHTML;
                                    lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                    lis[1].innerText = 'Credit - ' + NewData[2].innerText;
                                    lis[2].innerText = 'Balance = ' + NewData[3].innerText;
                                    lis[3].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                    lis[4].innerText = 'Share = ' + NewData[5].innerText;
                                    lis[5].innerText = 'Exposure = ' + NewData[6].innerText;
                                    lis[6].innerText = 'Available Balance = ' + NewData[7].innerText;
                                    lis[7].innerHTML = NewData[8].innerHTML;
                                }

                            }
                            else {
                                document.getElementById(id).innerHTML = "";
                                document.getElementById(id).innerHTML = data;
                            }


                }
                else
                {
                                var id = "row-" + mid;
                                var lis = $("#" + id).next('.child').find("li");

                                if (isMobileDevice()) {

                                    if (lis.length == 6) {
                                        var NewData = $(data).find("tr,td");
                                        var tds = $("#" + id).find("tr,td");
                                        tds[0].html = NewData[0].innerHTML;
                                        tds[1].innerText = NewData[1].innerText;
                                        tds[2].innerText = NewData[2].innerText;

                                        lis[0].innerText = 'Balance = ' + NewData[3].innerText;
                                        lis[1].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                        lis[2].innerText = 'Share = ' + NewData[5].innerText;
                                        lis[3].innerText = 'Exposure = ' + NewData[6].innerText;
                                        lis[4].innerText = 'Available Balance = ' + NewData[7].innerText;
                                        lis[5].innerHTML = NewData[8].innerHTML;
                                    }
                                    if (lis.length == 7) {
                                        var NewData = $(data).find("tr,td");
                                        var tds = $("#" + id).find("tr,td");
                                        tds[0].innerHTML = NewData[0].innerHTML;
                                        tds[2].innerText = NewData[2].innerText;

                                        lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                        lis[1].innerText = 'Balance = ' + NewData[3].innerText;
                                        lis[2].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                        lis[3].innerText = 'Share = ' + NewData[5].innerText;
                                        lis[4].innerText = 'Exposure = ' + NewData[6].innerText;
                                        lis[5].innerText = 'Available Balance = ' + NewData[7].innerText;
                                        lis[6].innerHTML = NewData[8].innerHTML;
                                    }
                                    if (lis.length == 8) {
                                        var NewData = $(data).find("tr,td");
                                        var tds = $("#" + id).find("tr,td");
                                        tds[0].innerHTML = NewData[0].innerHTML;
                                        lis[0].innerText = 'Type - ' + NewData[1].innerText;
                                        lis[1].innerText = 'Credit - ' + NewData[2].innerText;
                                        lis[2].innerText = 'Balance = ' + NewData[3].innerText;
                                        lis[3].innerText = 'Client (P/L) = ' + NewData[4].innerText;
                                        lis[4].innerText = 'Share = ' + NewData[5].innerText;
                                        lis[5].innerText = 'Exposure = ' + NewData[6].innerText;
                                        lis[6].innerText = 'Available Balance = ' + NewData[7].innerText;
                                        lis[7].innerHTML = NewData[8].innerHTML;
                                    }

                                }
                                 else {
                                    document.getElementById(id).innerHTML = "";
                                    document.getElementById(id).innerHTML = data;
                                }
                }
            }
            )
        };

        function isMobileDevice() {
            var check = false;
            (function (a) { if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);
            return check;
        };
    </script>
   <script>
        function LoadFullAccounts(mid) {
            $("#accountLoadGif").show();
            $("#accountLoadGif").next().hide();
            $.get('/Accounts/Chart?handler=Details&MID=' + mid, function (data) {
                $("#accountsChart").html(data);

                var tblLed = $("#tableLedger").DataTable({
                    paging: false,
                    ordering: false,
                    columnDefs: [
                        { responsivePriority: 1, targets: 0 },
                        { responsivePriority: 2, targets: 2 }
                    ]
                });

                if (IsMobile()) {
                    new $.fn.dataTable.Responsive(tblLed, {
                        details: {
                            display: $.fn.dataTable.Responsive.display.childRowImmediate
                        }
                    });
                }
            });
        }

    </script>

  

    <script>
        const token = getCookie('wexscktoken');
        const sess = getCookie('wex3authtoken');
        const reft = getCookie('wex3reftoken');

        $(document).ready(function () {
            pollUserData();

            pollRefreshToken();
        });
    </script>
</body>




</html>